window.coffeeTypes = [
    {
        name: 'Bicerin',
        containerId: 'coffee-Bicerin-container',
        buttonId: 'coffee-Bicerin-button',
        priceDisplayId: 'coffee-Bicerin-price',
        productionRateDisplayId: 'coffee-Bicerin-production-rate',
        levelDisplayId: 'coffee-Bicerin-level',
        level: 0,
        basePrice: 10,
        currentPrice: 10,
        productionRate: 0,
        productionBaseRate: 1,
        index: 0,
        unlocked: true,
        maxLevel: 25
    },
    {
        name: 'Morocchino',
        containerId: 'coffee-Morocchino-container',
        buttonId: 'coffee-Morocchino-button',
        priceDisplayId: 'coffee-Morocchino-price',
        productionRateDisplayId: 'coffee-Morocchino-production-rate',
        levelDisplayId: 'coffee-Morocchino-level',
        level: 0,
        basePrice: 100,
        currentPrice: 100,
        productionRate: 0,
        productionBaseRate: 10,
        index: 1,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Glace',
        containerId: 'coffee-Glace-container',
        buttonId: 'coffee-Glace-button',
        priceDisplayId: 'coffee-Glace-price',
        productionRateDisplayId: 'coffee-Glace-production-rate',
        levelDisplayId: 'coffee-Glace-level',
        level: 0,
        basePrice: 1000,
        currentPrice: 1000,
        productionRate: 0,
        productionBaseRate: 100,
        index: 2,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'MeadRaf',
        containerId: 'coffee-MeadRaf-container',
        buttonId: 'coffee-MeadRaf-button',
        priceDisplayId: 'coffee-MeadRaf-price',
        productionRateDisplayId: 'coffee-MeadRaf-production-rate',
        levelDisplayId: 'coffee-MeadRaf-level',
        level: 0,
        basePrice: 10000,
        currentPrice: 10000,
        productionRate: 0,
        productionBaseRate: 1000,
        index: 3,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Romano',
        containerId: 'coffee-Romano-container',
        buttonId: 'coffee-Romano-button',
        priceDisplayId: 'coffee-Romano-price',
        productionRateDisplayId: 'coffee-Romano-production-rate',
        levelDisplayId: 'coffee-Romano-level',
        level: 0,
        basePrice: 100000,
        currentPrice: 100000,
        productionRate: 0,
        productionBaseRate: 10000,
        index: 4,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'RafCoffe',
        containerId: 'coffee-RafCoffe-container',
        buttonId: 'coffee-RafCoffe-button',
        priceDisplayId: 'coffee-RafCoffe-price',
        productionRateDisplayId: 'coffee-RafCoffe-production-rate',
        levelDisplayId: 'coffee-RafCoffe-level',
        level: 0,
        basePrice: 1000000,
        currentPrice: 1000000,
        productionRate: 0,
        productionBaseRate: 100000,
        index: 5,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Fredo',
        containerId: 'coffee-Fredo-container',
        buttonId: 'coffee-Fredo-button',
        priceDisplayId: 'coffee-Fredo-price',
        productionRateDisplayId: 'coffee-Fredo-production-rate',
        levelDisplayId: 'coffee-Fredo-level',
        level: 0,
        basePrice: 10000000,
        currentPrice: 10000000,
        productionRate: 0,
        productionBaseRate: 1000000,
        index: 6,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'LatteMacchiato',
        containerId: 'coffee-LatteMacchiato-container',
        buttonId: 'coffee-LatteMacchiato-button',
        priceDisplayId: 'coffee-LatteMacchiato-price',
        productionRateDisplayId: 'coffee-LatteMacchiato-production-rate',
        levelDisplayId: 'coffee-LatteMacchiato-level',
        level: 0,
        basePrice: 100000000,
        currentPrice: 100000000,
        productionRate: 0,
        productionBaseRate: 10000000,
        index: 7,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Breve',
        containerId: 'coffee-Breve-container',
        buttonId: 'coffee-Breve-button',
        priceDisplayId: 'coffee-Breve-price',
        productionRateDisplayId: 'coffee-Breve-production-rate',
        levelDisplayId: 'coffee-Breve-level',
        level: 0,
        basePrice: 1000000000,
        currentPrice: 1000000000,
        productionRate: 0,
        productionBaseRate: 100000000,
        index: 8,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'ConPanna',
        containerId: 'coffee-ConPanna-container',
        buttonId: 'coffee-ConPanna-button',
        priceDisplayId: 'coffee-ConPanna-price',
        productionRateDisplayId: 'coffee-ConPanna-production-rate',
        levelDisplayId: 'coffee-ConPanna-level',
        level: 0,
        basePrice: 10000000000,
        currentPrice: 10000000000,
        productionRate: 0,
        productionBaseRate: 1000000000,
        index: 9,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Latte',
        containerId: 'coffee-Latte-container',
        buttonId: 'coffee-Latte-button',
        priceDisplayId: 'coffee-Latte-price',
        productionRateDisplayId: 'coffee-Latte-production-rate',
        levelDisplayId: 'coffee-Latte-level',
        level: 0,
        basePrice: 100000000000,
        currentPrice: 100000000000,
        productionRate: 0,
        productionBaseRate: 10000000000,
        index: 10,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Macchiato',
        containerId: 'coffee-Macchiato-container',
        buttonId: 'coffee-Macchiato-button',
        priceDisplayId: 'coffee-Macchiato-price',
        productionRateDisplayId: 'coffee-Macchiato-production-rate',
        levelDisplayId: 'coffee-Macchiato-level',
        level: 0,
        basePrice: 1000000000000,
        currentPrice: 1000000000000,
        productionRate: 0,
        productionBaseRate: 100000000000,
        index: 11,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Cappuccino',
        containerId: 'coffee-Cappuccino-container',
        buttonId: 'coffee-Cappuccino-button',
        priceDisplayId: 'coffee-Cappuccino-price',
        productionRateDisplayId: 'coffee-Cappuccino-production-rate',
        levelDisplayId: 'coffee-Cappuccino-level',
        level: 0,
        basePrice: 10000000000000,
        currentPrice: 10000000000000,
        productionRate: 0,
        productionBaseRate: 1000000000000,
        index: 12,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'FlatWhite',
        containerId: 'coffee-FlatWhite-container',
        buttonId: 'coffee-FlatWhite-button',
        priceDisplayId: 'coffee-FlatWhite-price',
        productionRateDisplayId: 'coffee-FlatWhite-production-rate',
        levelDisplayId: 'coffee-FlatWhite-level',
        level: 0,
        basePrice: 100000000000000,
        currentPrice: 100000000000000,
        productionRate: 0,
        productionBaseRate: 10000000000000,
        index: 13,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Americano',
        containerId: 'coffee-Americano-container',
        buttonId: 'coffee-Americano-button',
        priceDisplayId: 'coffee-Americano-price',
        productionRateDisplayId: 'coffee-Americano-production-rate',
        levelDisplayId: 'coffee-Americano-level',
        level: 0,
        basePrice: 1000000000000000,
        currentPrice: 1000000000000000,
        productionRate: 0,
        productionBaseRate: 100000000000000,
        index: 14,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Lungo',
        containerId: 'coffee-Lungo-container',
        buttonId: 'coffee-Lungo-button',
        priceDisplayId: 'coffee-Lungo-price',
        productionRateDisplayId: 'coffee-Lungo-production-rate',
        levelDisplayId: 'coffee-Lungo-level',
        level: 0,
        basePrice: 10000000000000000,
        currentPrice: 10000000000000000,
        productionRate: 0,
        productionBaseRate: 1000000000000000,
        index: 15,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Ritretto',
        containerId: 'coffee-Ritretto-container',
        buttonId: 'coffee-Ritretto-button',
        priceDisplayId: 'coffee-Ritretto-price',
        productionRateDisplayId: 'coffee-Ritretto-production-rate',
        levelDisplayId: 'coffee-Ritretto-level',
        level: 0,
        basePrice: 100000000000000000,
        currentPrice: 100000000000000000,
        productionRate: 0,
        productionBaseRate: 10000000000000000,
        index: 16,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Tripplo',
        containerId: 'coffee-Tripplo-container',
        buttonId: 'coffee-Tripplo-button',
        priceDisplayId: 'coffee-Tripplo-price',
        productionRateDisplayId: 'coffee-Tripplo-production-rate',
        levelDisplayId: 'coffee-Tripplo-level',
        level: 0,
        basePrice: 1000000000000000000,
        currentPrice: 1000000000000000000,
        productionRate: 0,
        productionBaseRate: 100000000000000000,
        index: 17,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Doppio',
        containerId: 'coffee-Doppio-container',
        buttonId: 'coffee-Doppio-button',
        priceDisplayId: 'coffee-Doppio-price',
        productionRateDisplayId: 'coffee-Doppio-production-rate',
        levelDisplayId: 'coffee-Doppio-level',
        level: 0,
        basePrice: 10000000000000000000,
        currentPrice: 10000000000000000000,
        productionRate: 0,
        productionBaseRate: 1000000000000000000,
        index: 18,
        unlocked: false,
        maxLevel: 25
    },
    {
        name: 'Espresso',
        containerId: 'coffee-Espresso-container',
        buttonId: 'coffee-Espresso-button',
        priceDisplayId: 'coffee-Espresso-price',
        productionRateDisplayId: 'coffee-Espresso-production-rate',
        levelDisplayId: 'coffee-Espresso-level',
        level: 0,
        basePrice: 100000000000000000000,
        currentPrice: 100000000000000000000,
        productionRate: 0,
        productionBaseRate: 10000000000000000000,
        index: 19,
        unlocked: false,
        maxLevel: 25
    }
];

function updateCoffeeUI(coffee) {
    const container = document.getElementById(coffee.containerId);
    const button = document.getElementById(coffee.buttonId);
    const priceDisplay = document.getElementById(coffee.priceDisplayId);
    const productionRateDisplay = document.getElementById(coffee.productionRateDisplayId);
    const levelDisplay = document.getElementById(coffee.levelDisplayId);

    if (container) {
        container.style.display = coffee.unlocked ? 'flex' : 'none';
    }

    if (coffee.unlocked) {
        priceDisplay.textContent = formatPrice(coffee.currentPrice * (1 - (window.upgradeCostReduction || 0)));
        productionRateDisplay.textContent = formatPrice(coffee.productionRate) + ' / с';
        levelDisplay.textContent = `(Рівень ${coffee.level}/${coffee.maxLevel + (window.maxLevelIncrease || 0)})`;

        if (coffee.level >= coffee.maxLevel + (window.maxLevelIncrease || 0)) {
            button.disabled = true;
            button.textContent = 'Максимум';
        } else {
            button.disabled = false;
            button.textContent = 'Покращити';
        }
    }
}

document.addEventListener('DOMContentLoaded', function() {
    function buyCoffeeUpgrade(coffee) {
        if (coffee.level < coffee.maxLevel + (window.maxLevelIncrease || 0)) {
            if (window.playerMoney >= coffee.currentPrice) {
                window.playerMoney -= coffee.currentPrice;
                coffee.level++;
                coffee.productionRate = coffee.level * coffee.productionBaseRate;
                coffee.currentPrice *= 1.1; // Підвищення на 10%

                updateMoneyUI();
                updateCoffeeUI(coffee);
            }
        }
    }

    window.coffeeTypes.forEach(coffee => {
        const button = document.getElementById(coffee.buttonId);
        if (button) {
            button.addEventListener('click', () => buyCoffeeUpgrade(coffee));
        }
        updateCoffeeUI(coffee);
    });

    function gameTick() {
        window.coffeeTypes.forEach(coffee => {
            window.playerMoney += coffee.productionRate;
        });
        updateMoneyUI();
    }

    setInterval(gameTick, 1000);
});


function updateMoneyUI() {
    const moneyDisplay = document.querySelector('.top-left-container .upper-text:nth-child(3)');
    if (moneyDisplay) {
        moneyDisplay.textContent = formatPrice(window.playerMoney);
    }
}

function formatPrice(price) {
    if (price >= 1e15) {
        return price.toExponential(0);
    } else {
        return price.toFixed(0);
    }
}